- job:
    name: zuul-jobs-test-registry
    description: |
      Test the intermediate registry roles.

      This job tests changes to the intermediate registry roles.  It
      is not meant to be used directly but rather run on changes to
      roles in the zuul-jobs repo.
    files:
      - roles/pull-from-intermediate-registry/.*
      - roles/push-to-intermediate-registry/.*
      - roles/install-docker/.*
      - roles/build-docker-image/.*
      - roles/run-buildset-registry/.*
      - roles/use-buildset-registry/.*
      - test-playbooks/registry/.*
    run: test-playbooks/registry/test-registry.yaml
    post-run: test-playbooks/registry/test-registry-post.yaml
    nodeset:
      nodes:
        - name: intermediate-registry
          label: ubuntu-bionic
        - name: executor
          label: ubuntu-bionic
        - name: builder
          label: ubuntu-bionic

- job:
    name: zuul-jobs-test-install-kubernetes
    description: |
      Test the install-kubernetes role

      This job tests changes to the install-kubernetes roles.  It
      is not meant to be used directly but rather run on changes to
      roles in the zuul-jobs repo.
    files:
      - roles/install-docker/.*
      - roles/install-kubernetes/.*
      - test-playbooks/install-kubernetes.yaml
    run: test-playbooks/install-kubernetes.yaml
    nodeset:
      nodes:
        - name: primary
          label: ubuntu-bionic

# List all the jobs in this file.

- project:
    check:
      jobs: &id001
        - zuul-jobs-test-registry
        - zuul-jobs-test-install-kubernetes
    gate:
      jobs: *id001
